<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>40. Parsing JSON with Python</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1>Parsing JSON with Python</h1><br /><br /><h2>Reading and Writing Files</h2><br /><br />• Reading-from and writing-to text files with Python's built-in <code>open()</code> function<br />• It returns a file object that we can use to read-from and/or write-to the file that we opened<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;Open&nbsp;a&nbsp;file&nbsp;for&nbsp;reading</span><br />file&nbsp;=&nbsp;open(<span style="color:#3ad900;font-weight:400">"path/to/file"</span>,&nbsp;mode=<span style="color:#3ad900;font-weight:400">"r"</span>)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Read&nbsp;and&nbsp;print&nbsp;contents&nbsp;of&nbsp;a&nbsp;file</span><br />file_contents&nbsp;=&nbsp;file.read()<br /><span style="color:#ff9d00;font-weight:700">print</span>(file_contents)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Close&nbsp;the&nbsp;file</span><br />file.close()</div></div><br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;Open&nbsp;a&nbsp;file&nbsp;for&nbsp;writing</span><br />file&nbsp;=&nbsp;open(<span style="color:#3ad900;font-weight:400">"path/to/file"</span>,&nbsp;mode=<span style="color:#3ad900;font-weight:400">"w"</span>)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Write&nbsp;and&nbsp;print&nbsp;contents&nbsp;of&nbsp;a&nbsp;file</span><br />file_contents&nbsp;=&nbsp;file.write(<span style="color:#3ad900;font-weight:400">"add&nbsp;something"</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>(file_contents)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Close&nbsp;the&nbsp;file</span><br />file.close()</div></div><br /><br />• <code>mode</code> is an optional string that specifies the mode in which the file is opened. It defaults to 'r' (read). Other common values are 'w' for writing (truncating the file if it already exists)<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /> <br /><h2>The </h2><code><h2>with</h2></code><h2> statement</h2><br /><br />• The with statement initiates context manager for Python<br />• No need to explicitly close the file as this will be handled by the context manager<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;'with'&nbsp;statement</span><br />&gt;&gt;&gt;&nbsp;with&nbsp;open(<span style="color:#3ad900;font-weight:400">"intro-python/parsing-json/pep20.txt"</span>,&nbsp;mode=<span style="color:#3ad900;font-weight:400">"r"</span>)&nbsp;<span style="color:#333333;font-weight:400">as</span>&nbsp;file:<br />&nbsp;&nbsp;&nbsp;&nbsp;file_contents&nbsp;=&nbsp;file.read()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(file_contents)</div></div><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>JSON Syntax vs. Python Native Data Type</h2><br /><br />• <strong>The use of single vs. double quotes</strong>: Python doesn't care, but JSON does. JSON strings must be delineated using double quotes " ".<br />• <strong>The capitalization of the boolean values</strong>:  Python uses <em>True</em> and <em>False</em> , while JSON uses an all-lowercase convention of <em>true</em> and <em>false</em><br />• <strong>Trailing commas</strong>: Python ignores any trailing commas, but JSON will complain if you accidentally leave some trailing commas in your JSON data<br /><br />• Python can use any immutable and hash-able data type as a name in a dictionary. JSON names must be strings<br />• The outermost element of a JSON data structure must be an "object" (which is the JSON name for a name-value pair data structure, like Python's dictionary)<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>What is Parsing?</h2><br /><br />• Parsing is the process of analyzing text into its logical syntactic components<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Using the Python </h2><code><h2>json</h2></code><h2> module</h2><br /><br />• Not all Python data structures can be parsed into JSON notation. For example, if you created your own class<br />• It is best to stick with Python's native data structures (<code>dict</code>, <code>list</code>, etc.) when you want your data to be able to be encoded as JSON text<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/env&nbsp;python</span><br /><br /><span style="color:#3ad900;font-weight:400">"""<br />Parsing&nbsp;structured&nbsp;JSON&nbsp;text&nbsp;into&nbsp;native&nbsp;Python&nbsp;data&nbsp;structures...<br />"""</span><br /><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;json<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;os<br /><span style="color:#333333;font-weight:400">from</span>&nbsp;pprint&nbsp;<span style="color:#333333;font-weight:400">import</span>&nbsp;pprint<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Get&nbsp;the&nbsp;absolute&nbsp;path&nbsp;for&nbsp;the&nbsp;directory&nbsp;where&nbsp;this&nbsp;file&nbsp;is&nbsp;located&nbsp;"here"</span><br />here&nbsp;=&nbsp;os.path.abspath(os.path.dirname(__file__))<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Read&nbsp;in&nbsp;the&nbsp;JSON&nbsp;text</span><br />with&nbsp;open(os.path.join(here,&nbsp;<span style="color:#3ad900;font-weight:400">"interface-config.json"</span>))&nbsp;<span style="color:#333333;font-weight:400">as</span>&nbsp;file:<br />&nbsp;&nbsp;&nbsp;&nbsp;json_text&nbsp;=&nbsp;file.read()<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Display&nbsp;the&nbsp;type&nbsp;and&nbsp;contents&nbsp;of&nbsp;the&nbsp;json_text&nbsp;variable</span><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">"json_text&nbsp;is&nbsp;a"</span>,&nbsp;type(json_text))<br /><span style="color:#ff9d00;font-weight:700">print</span>(json_text)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Use&nbsp;the&nbsp;json&nbsp;module&nbsp;to&nbsp;parse&nbsp;the&nbsp;JSON&nbsp;string&nbsp;into&nbsp;native&nbsp;Python&nbsp;data</span><br />json_data&nbsp;=&nbsp;json.loads(json_text)<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Display&nbsp;the&nbsp;type&nbsp;and&nbsp;contents&nbsp;of&nbsp;the&nbsp;json_data&nbsp;variable</span><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">"json_data&nbsp;is&nbsp;a"</span>,&nbsp;type(json_data))<br />pprint(json_data)</div></div><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Working with Nested Data</h2><br /><br /><img src="images\143-1.png" alt="images\143-1.png" /><br /><br />• This is the case with the <code>ip</code> address in the JSON example below<br /> <br /><div class="codebox"><div class="codebox">{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ietf-interfaces:interface"</span>:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"name"</span>:&nbsp;<span style="color:#3ad900;font-weight:400">"GigabitEthernet2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"description"</span>:&nbsp;<span style="color:#3ad900;font-weight:400">"Wide&nbsp;Area&nbsp;Network"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"enabled"</span>:&nbsp;true,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ietf-ip:ipv4"</span>:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"address"</span>:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"ip"</span>:&nbsp;<span style="color:#3ad900;font-weight:400">"172.16.0.2"</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"netmask"</span>:&nbsp;<span style="color:#3ad900;font-weight:400">"255.255.255.0"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</div></div><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Indexing Nested Data</h2><br /><br />• We access an element within a Python data structure using the square braces <code>[ ]</code> and the index of the item we want to "extract"<br />• Dictionaries use names as their index<br />• Lists use the numerical index of where each element sits in the ordered sequence (starting at zero)<br /><br /><h3>Example</h3><br /><br />• Extracting the "ietf-interfaces:interface" dictionary from the top-level dictionary in from JSON sample above<br /><br /><div class="codebox"><div class="codebox">&gt;&gt;&gt;&nbsp;pprint(json_data[<span style="color:#3ad900;font-weight:400">"ietf-interfaces:interface"</span>])<br /><br />{<span style="color:#3ad900;font-weight:400">'description'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">'Wide&nbsp;Area&nbsp;Network'</span>,<br />&nbsp;<span style="color:#3ad900;font-weight:400">'enabled'</span>:&nbsp;<span style="color:#ff0044;font-weight:400">True</span>,<br />&nbsp;<span style="color:#3ad900;font-weight:400">'ietf-ip:ipv4'</span>:&nbsp;{<span style="color:#3ad900;font-weight:400">'address'</span>:&nbsp;[{<span style="color:#3ad900;font-weight:400">'ip'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">'172.16.0.2'</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'netmask'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">'255.255.255.0'</span>}]},<br />&nbsp;<span style="color:#3ad900;font-weight:400">'name'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">'GigabitEthernet2'</span>}</div></div><br /><br />• To get the ip address of the "ietf-interfaces:interface" dictionary<br /><br /><div class="codebox"><div class="codebox">&gt;&gt;&gt;&nbsp;json_data[<span style="color:#3ad900;font-weight:400">"ietf-interfaces:interface"</span>][<span style="color:#3ad900;font-weight:400">"ietf-ip:ipv4"</span>][<span style="color:#3ad900;font-weight:400">"address"</span>][<span style="color:#ff0044;font-weight:400">0</span>][<span style="color:#3ad900;font-weight:400">"ip"</span>]<br /><br /><span style="color:#3ad900;font-weight:400">'172.16.0.2'</span></div></div><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Looping Through Nested Data</h2><br /><br /><h3>Looping through a </h3><code><h3>list</h3></code><h3>:</h3><br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;Looping&nbsp;through&nbsp;a&nbsp;list</span><br />&gt;&gt;&gt;&nbsp;my_list&nbsp;=&nbsp;[<span style="color:#ff0044;font-weight:400">0</span>,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,&nbsp;<span style="color:#ff0044;font-weight:400">2</span>,&nbsp;<span style="color:#ff0044;font-weight:400">3</span>,&nbsp;<span style="color:#ff0044;font-weight:400">4</span>]<br />&gt;&gt;&gt;&nbsp;for&nbsp;item&nbsp;in&nbsp;my_list:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(item)<br /><br /><span style="color:#ff0044;font-weight:400">0</span><br /><span style="color:#ff0044;font-weight:400">1</span><br /><span style="color:#ff0044;font-weight:400">2</span><br /><span style="color:#ff0044;font-weight:400">3</span><br /><span style="color:#ff0044;font-weight:400">4</span>&nbsp;&nbsp;&nbsp;</div></div><br /><br /><h3>Looping through a </h3><code><h3>dict</h3></code><h3>:</h3><br />• use variable unpacking and the dictionary <code>.items()</code> method<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;Looping&nbsp;through&nbsp;a&nbsp;dictionary</span><br />&gt;&gt;&gt;&nbsp;fruit_inventory&nbsp;=&nbsp;{<span style="color:#3ad900;font-weight:400">"apples"</span>:&nbsp;<span style="color:#ff0044;font-weight:400">5</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"pears"</span>:&nbsp;<span style="color:#ff0044;font-weight:400">2</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"oranges"</span>:&nbsp;<span style="color:#ff0044;font-weight:400">9</span>}<br />&gt;&gt;&gt;&nbsp;for&nbsp;fruit,&nbsp;quantity&nbsp;in&nbsp;fruit_inventory.items():<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">"You&nbsp;have&nbsp;{}&nbsp;{}."</span>.format(quantity,&nbsp;fruit))<br /><br />You&nbsp;have&nbsp;<span style="color:#ff0044;font-weight:400">5</span>&nbsp;apples.<br />You&nbsp;have&nbsp;<span style="color:#ff0044;font-weight:400">2</span>&nbsp;pears.<br />You&nbsp;have&nbsp;<span style="color:#ff0044;font-weight:400">9</span>&nbsp;oranges.</div></div><br /><br /><h3>To loop through nested data, all you need to do is:</h3><br /><br />1. "Extract" the element that you want to loop through<br />2. Use that element as the target of your for loop<br />3. Within your for loop, your loop variable(s) will iteratively be assigned the values of the items within the element you are iterating<br /><br /><h3>Example</h3><br /><br /><div class="codebox"><div class="codebox">for&nbsp;interface&nbsp;in&nbsp;json_data[<span style="color:#3ad900;font-weight:400">"ietf-interfaces:interfaces"</span>][<span style="color:#3ad900;font-weight:400">"interface"</span>]:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(interface[<span style="color:#3ad900;font-weight:400">"name"</span>])</div></div><br /><br /><br /><br /><p align="center"><img src="images\home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>