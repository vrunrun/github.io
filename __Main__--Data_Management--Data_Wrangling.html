<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Data Wrangling</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1>Data Wrangling (Preparation)</h1><br /><br /><h2>Overview</h2><br /><br />• One purpose of data wrangling is to keep the data formats consistent so that it can be uploaded to database or other programs smoothly<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Folder Strcture</h2><br /><br />• Create a Template Folder and name it <strong>!YYYYMMDD_&lt;Project Name&gt;</strong><br />• Inside the Template folder, include the following sub-folders<br />   ◇ 1. Original Data<br />   ◇ 2. Prepared Data<br />   ◇ 3. Uploaded Data<br />   ◇ 4. Analysis<br />   ◇ 5. Insights<br />   ◇ 6. Final<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>How Excel Can Mess Up Your Data</h2><br /><br />• Excel can mess up your Dates and Numeric formats if your locale configuartion is not the default settings<br />• Example: a CSV file with dates and credit card number (16-digits)<br />• After you open the CSV file in Excel and exit without saving it, if you open the same file with text editor again, notice the following changes were made by Excel implicitly<br />• <strong>Date format</strong>: Changed from American format to European format as per Regional settings<br />• <strong>Long Integer</strong>: Changed to Scienific Display format<br /> <br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Two Things You HAVE to Do Before Uploading Data</h2><br /><br /><h3>1) Fix Up the Dates in CSV Files</h3><br /><br />• Accounts for different date formats<br />• In Excel, right click the column &gt; Format Cells &gt; choose / create <em>“yyyy-mm-dd”</em><br />• After the fix, if you open the file in Excel, notice that the dates will be displayed according to your Regional Setting so you may not see the dates displayed in “yyyy-mm-dd”<br />• The <strong>proper way to check the result</strong> is to open the file in your favourite text editor<br /><br /><h3>2) Fix Up the Amounts in CSV Files</h3><br /><br />• To get rid of the dollar signs ($), commas (,) and make sure that decimals places are represented by dots (.)<br />   ◇ In Excel, right click the column &gt; Format Cells &gt; Number<br />   ◇ Make sure that “Use 1000 separator” is unchecked<br />   ◇ Some country settings will represent decimals as comma<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Quick Check List</h2><br /><br /><div class="codebox"><div class="codebox">-&nbsp;Amounts&nbsp;are&nbsp;without&nbsp;$&nbsp;sign&nbsp;and&nbsp;comma<br />-&nbsp;Dates&nbsp;are&nbsp;in&nbsp;“YYYY-MM-DD”&nbsp;format<br />-&nbsp;Long&nbsp;integers&nbsp;like&nbsp;credit&nbsp;card&nbsp;numbers&nbsp;can&nbsp;be&nbsp;seen&nbsp;with&nbsp;all&nbsp;digits&nbsp;(no&nbsp;scientific&nbsp;notation)<br />-&nbsp;No&nbsp;hash&nbsp;tags&nbsp;on&nbsp;long&nbsp;text</div></div><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h2>Bulletproof Blueprint for Data Wrangling</h2><br /><br />• Ideal for database upload. Follow the steps below:<br /><br />1. Copy file &lt;file_name&gt;.csv from folder “1. Original Data” to folder “2. Prepared Data”<br /><br />2. In folder “2. Prepared Data”, change the file extension from .csv to .txt<br /><br />3. Open &lt;file_name&gt;.txt in Excel<br /><br />4. Use File &gt; Open as this will bring up the Import Wizard<br /><br />5. In the Import Wizard, Select all columns, choose “Text” as data format and click “Finish”<br /><br />6. Fix Date formatting: highlight the column with dates, select Data &gt; Text to Columns<br />   ◇ In the Convert Text to Column Wizard<br />    6-1: Choose “Delimited” and click “Next”<br />    6-2: De-select all delimiters and click “Next”<br />    6-3: Choose the Date format and click “Finish”<br />   ◇ Select the column, right click and choose “Format Cells...”. Go to Custom and specify the format we need “YYYY-MM-DD”<br />   ◇ Do the same for other columns with dates<br /><br />7. Fix Number formatting: highlight column with numbers, select Data &gt; Text to Column<br />   ◇ In the Convert Text to Columns Wizard, perform the same thing in steps 1 and 2. In step 3, select “General” and click “Finish”<br />   ◇ Highlight column with numbers, right click and choose “Format Cells...”, choose “Number”, 2 decimal places, no thousand separator and use “-” for negative numbers and then click “OK”<br />   ◇ Do the same for other columns with numbers<br /><br />8. Fix Long Text (&gt; 256 characters)<br />• If the text is too long (&gt; 256 characters), the text is replaced by hash tag<br />• To fix this, select the column, right click and select “Format cells...” . Select “General” category and click OK<br />• Do the same for other columns with long text<br /><br />9. Save the File as CSV file<br /><br />10. The file is ready to upload<p align="center"><img src="images\home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>