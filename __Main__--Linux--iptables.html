<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>iptables</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body>• use iptables for ipv4<br />• use ip6tables for ipv6<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;List&nbsp;of&nbsp;rules</span><br />iptables&nbsp;-L<br />iptables&nbsp;-L&nbsp;-v&nbsp;--line-number&nbsp;-n<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Remove&nbsp;all&nbsp;rules</span><br />iptables&nbsp;-F<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;view&nbsp;commands&nbsp;input&nbsp;to&nbsp;create&nbsp;rules</span><br />iptables&nbsp;-S<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Save</span><br /><span style="color:#ff9d00;font-weight:700">/</span>sbin<span style="color:#ff9d00;font-weight:700">/</span>iptables-save<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Delete&nbsp;a&nbsp;particular&nbsp;rule</span><br />iptables&nbsp;-D&nbsp;OUTPUT&nbsp;5</div></div><br /><br /><h2>Enable a laptop to surf the web</h2><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#&nbsp;Default</span><br />iptables&nbsp;-P&nbsp;INPUT&nbsp;DROP<br />iptables&nbsp;-P&nbsp;FORWARD&nbsp;DROP<br />iptables&nbsp;-P&nbsp;OUTPUT&nbsp;DROP<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Accept&nbsp;all&nbsp;incoming&nbsp;traffic</span><br />iptables&nbsp;-A&nbsp;INPUT&nbsp;-i&nbsp;lo&nbsp;-j&nbsp;ACCEPT<br /><span style="color:#0088ff;font-weight:400">#&nbsp;A:&nbsp;append;&nbsp;i:&nbsp;interface;&nbsp;j:&nbsp;jump&nbsp;swtich</span><br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Dynamic&nbsp;packet&nbsp;filtering</span><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Exclude&nbsp;packet&nbsp;with&nbsp;state=NEW</span><br />iptables&nbsp;-A&nbsp;INPUT&nbsp;-m&nbsp;state&nbsp;--state&nbsp;RELATED,ESTABLISHED&nbsp;-j&nbsp;ACCEPT<br /><span style="color:#0088ff;font-weight:400">#&nbsp;-m:&nbsp;load&nbsp;module</span><br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Accept&nbsp;all&nbsp;outgoing&nbsp;traffic</span><br />iptables&nbsp;-A&nbsp;OUTPUT&nbsp;-o&nbsp;lo&nbsp;-j&nbsp;ACCEPT<br />iptables&nbsp;-A&nbsp;OUTPUT&nbsp;-m&nbsp;state&nbsp;--state&nbsp;ESTABLISHED,RELATED&nbsp;-j&nbsp;ACCEPT<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Allow&nbsp;DNS&nbsp;query</span><br />iptables&nbsp;-A&nbsp;OUTPUT&nbsp;-o&nbsp;eth0&nbsp;-p&nbsp;udp&nbsp;-m&nbsp;udp&nbsp;--dport&nbsp;53&nbsp;-j&nbsp;ACCEPT<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Allow&nbsp;http&nbsp;traffic</span><br />iptables&nbsp;-A&nbsp;OUTPUT&nbsp;-o&nbsp;eth0&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-m&nbsp;state&nbsp;--state&nbsp;NEW&nbsp;-j&nbsp;ACCEPT<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Allow&nbsp;https&nbsp;traffic</span><br />iptables&nbsp;-A&nbsp;OUTPUT&nbsp;-o&nbsp;eth0&nbsp;-p&nbsp;tcp&nbsp;-m&nbsp;tcp&nbsp;--dport&nbsp;443&nbsp;-m&nbsp;state&nbsp;--state&nbsp;NEW&nbsp;-j&nbsp;ACCEPT<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Verify</span><br /><span style="color:#ff9d00;font-weight:700">wget</span>&nbsp;http<span style="color:#ff9d00;font-weight:700">://</span>www.bbc.co.uk<br /><span style="color:#ff9d00;font-weight:700">wget</span>&nbsp;https<span style="color:#ff9d00;font-weight:700">://</span>www.bbc.co.uk<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Switch&nbsp;off&nbsp;the&nbsp;firewall</span><br />iptables&nbsp;-t&nbsp;nat&nbsp;-F<br />iptables&nbsp;-t&nbsp;mangle&nbsp;-F<br />iptables&nbsp;-F<br />iptables&nbsp;-X<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;Disable&nbsp;ipv6</span><br />ip6tables&nbsp;-P&nbsp;INPUT&nbsp;DROP<br />ip6tables&nbsp;-P&nbsp;FORWARD&nbsp;DROP<br />ip6tables&nbsp;-P&nbsp;OUTPUT&nbsp;DROP<br /></div></div><br /><br /><h2>Reference</h2><br /><a href="http://tech.meetrp.com/blog/iptables-personal-firewall-to-protect-my-laptop/">IPTABLES: Personal Firewall to Protect Laptop</a><br /><a href="https://github.com/meetrp/personalfirewall">IPTABLES script</a><br /><br /><br /><p align="center"><img src="images\home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>